<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>slackget10::File - A class to manage files.</title>
<link rel="stylesheet" href="http://search.cpan.org/s/style.css" type="text/css" />
<link rev="made" href="mailto:root@midas.slackware.lan" />
</head>

<body>

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#version">VERSION</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#constructor">CONSTRUCTOR</a></li>
	<ul>

		<li><a href="#new">new</a></li>
	</ul>

	<li><a href="#functions">FUNCTIONS</a></li>
	<ul>

		<li><a href="#read">Read</a></li>
		<li><a href="#lock_file">Lock_file</a></li>
		<li><a href="#unlock_file">Unlock_file</a></li>
		<li><a href="#is_locked">is_locked</a></li>
		<li><a href="#write">Write</a></li>
		<li><a href="#add">Add</a></li>
		<li><a href="#get_file">Get_file</a></li>
		<li><a href="#get_line">Get_line</a></li>
		<li><a href="#get_selection">Get_selection</a></li>
		<li><a href="#close">Close</a></li>
		<li><a href="#write_and_close">Write_and_close</a></li>
		<li><a href="#encoding">encoding</a></li>
		<li><a href="#filename">filename</a></li>
	</ul>

	<li><a href="#author">AUTHOR</a></li>
	<li><a href="#bugs">BUGS</a></li>
	<li><a href="#acknowledgements">ACKNOWLEDGEMENTS</a></li>
	<li><a href="#copyright___license">COPYRIGHT &amp; LICENSE</a></li>
</ul>
<!-- INDEX END -->

<hr />
<p>
</p>
<h1><a name="name">NAME</a></h1>
<p>slackget10::File - A class to manage files.</p>
<p>
<a href="#__index__"><small>Top</small></a>
</p>
<hr />
<h1><a name="version">VERSION</a></h1>
<p>Version 1.0.0</p>
<p>
<a href="#__index__"><small>Top</small></a>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<p>slackget10::File is the class which represent a file for slack-get. You can perform all operation on file with this module.</p>
<p>Access to hard disk are economized by taking a copy of the file in memory, so if you work on big file it may be a bad idea to use this module. Or maybe you have some interest to close the file while you don't work on it.</p>
<pre>
        use slackget10::File;</pre>
<pre>
        my $file = slackget10::File-&gt;new('foo.txt'); # if foo.txt exist the constructor will call the Read() method
        $file-&gt;add(&quot;an example\n&quot;);
        $file-&gt;Write();
        $file-&gt;Write(&quot;bar.txt&quot;); # write foo.txt (plus the addition) into bar.txt
        $file-&gt;Close(); # Free the memory !
        $file-&gt;Read(); # But the slackget10::File object is not destroy and you can re-load the file content
        $file-&gt;Read(&quot;baz.txt&quot;); # Or changing file (the object will be update with the new file)</pre>
<p>The main advantage of this module is that you don't work directly on the file but on a copy. So you can make errors, they won't be wrote until you call the <code>Write()</code> method</p>
<p>
<a href="#__index__"><small>Top</small></a>
</p>
<hr />
<h1><a name="constructor">CONSTRUCTOR</a></h1>
<p>
</p>
<h2><a name="new">new</a></h2>
<p>Take a filename as argument.</p>
<pre>
        my $file = slackget10::File-&gt;new('foo.txt'); # if foo.txt exist the constructor will call the Read() method
        $file-&gt;add(&quot;an example\n&quot;);
        $file-&gt;Write();
        $file-&gt;Write(&quot;bar.txt&quot;);</pre>
<p>Additionnaly you can pass an file encoding (default is utf8). For example as a European I prefer that files are stored and compile in the iso-8859-1 charset so I use the following :</p>
<pre>
        my $file = slackget10::File-&gt;new('foo.txt','file-encoding' =&gt; 'iso-8859-1');</pre>
<p>You can also disabling the auto load of the file by passing a parameter 'no-auto-load' =&gt; 1 :</p>
<pre>
        my $file = slackget10::File-&gt;new('foo.txt','file-encoding' =&gt; 'iso-8859-1', 'no-auto-load' =&gt; 1);</pre>
<p>
<a href="#__index__"><small>Top</small></a>
</p>
<hr />
<h1><a name="functions">FUNCTIONS</a></h1>
<p>
</p>
<h2><a name="read">Read</a></h2>
<p>Take a filename as argument, and load the file in memory.</p>
<pre>
        $file-&gt;Read($filename);</pre>
<p>You can call this method without passing parameters, if you have give a filename to the constructor.</p>
<pre>
        $file-&gt;Read();</pre>
<p>This method doesn't return the file, you must call <code>Get_file()</code> to do that.</p>
<p>
</p>
<h2><a name="lock_file">Lock_file</a></h2>
<p>This method lock the file for slack-get application (not really for others...) by creating a file with the name of the current open file plus a ``.lock''. This is not a protection but an information system for slack-getd sub process. This method return undef if the lock can't be made.</p>
<pre>
        my $file = new slackget10::File ('test.txt');
        $file-&gt;Lock_file ; # create a file test.txt.lock</pre>
<p>ATTENTION: You can only lock the current file of the object. With the previous example you can't do :</p>
<pre>
        $file-&gt;Lock_file('toto.txt') ;</pre>
<p>ATTENTION 2 : Don't forget to unlock your locked file :)</p>
<p>
</p>
<h2><a name="unlock_file">Unlock_file</a></h2>
<p>Unlock a locked file. Only the locker object can unlock a file ! Return 1 if all goes well, else return undef. Return 2 if the file was not locked. Return 0 (false in scalar context) if the file was locked but by another slackget10::File object.</p>
<pre>
        my $status = $file-&gt;Unlock_file ;</pre>
<p>Returned value are :</p>
<pre>
        0 : error -&gt; the file was locked by another instance of this class
        
        1 : ok lock removed
        
        2 : the file was not locked
        
        undef : unable to remove the lock.</pre>
<p>
</p>
<h2><a name="is_locked">is_locked</a></h2>
<p>Return 1 if the file is locked by a slackget10::File object, else return undef.</p>
<pre>
        print &quot;File is locked\n&quot; if($file-&gt;is_locked);</pre>
<p>
</p>
<h2><a name="write">Write</a></h2>
<p>Take a filename to write data and raw data</p>
<pre>
        $file-&gt;Write($filename,@data);</pre>
<p>You also can call this method without any parameter :</p>
<pre>
        $file-&gt;Write ;</pre>
<p>In this case, the <code>Write()</code> method will wrote data in memory into the last opened file (with <code>Read()</code> or new()).</p>
<p>The default encoding of this method is utf-8, pass an extra argument : file-encoding to the constructor to change that.</p>
<p>
</p>
<h2><a name="add">Add</a></h2>
<p>Take a table of lines and add them to the end of file image (in memory). You need to commit your change by calling the <code>Write()</code> method !</p>
<pre>
        $file-&gt;Add(@data);
        or
        $file-&gt;Add($data);
        or
        $file-&gt;Add(&quot;this is some data\n&quot;);</pre>
<p>
</p>
<h2><a name="get_file">Get_file</a></h2>
<p>Return the current file in memory as an array.</p>
<pre>
        @file = $file-&gt;Get_file();</pre>
<p>
</p>
<h2><a name="get_line">Get_line</a></h2>
<p>Return the $index line of the file (the index start at 0).</p>
<pre>
        @file = $file-&gt;Get_line($index);</pre>
<p>
</p>
<h2><a name="get_selection">Get_selection</a></h2>
<pre>
        Same as get file but return only lines between $start and $stop.</pre>
<pre>
        my @array = $file-&gt;Get_selection($start,$stop);</pre>
<p>You can ommit the $stop parameter (in this case <code>Get_line()</code> return the lines from $start to the end of file)</p>
<p>
</p>
<h2><a name="close">Close</a></h2>
<p>Free the memory. This method close the current file memory image. If you don't call the <code>Write()</code> method before closing, the changes you have made on the file are lost !</p>
<pre>
        $file-&gt;Close();</pre>
<p>
</p>
<h2><a name="write_and_close">Write_and_close</a></h2>
<p>An alias which call <code>Write()</code> and then Close();</p>
<pre>
        $file-&gt;Write_and_close();
        or
        $file-&gt;Write_and_close(&quot;foo.txt&quot;);</pre>
<p>
</p>
<h2><a name="encoding">encoding</a></h2>
<p>Without parameter return the current file encoding, with a parameter set the encoding for the current file.</p>
<pre>
        print &quot;The current file encoding is &quot;,$file-&gt;encoding,&quot;\n&quot;; # return the current encoding
        $file-&gt;encoding('utf8'); # set the current file encoding to utf8</pre>
<p>
</p>
<h2><a name="filename">filename</a></h2>
<p>Return the filename of the file which is currently process by the slackget10::File instance.</p>
<pre>
        print $file-&gt;filename</pre>
<p>
<a href="#__index__"><small>Top</small></a>
</p>
<hr />
<h1><a name="author">AUTHOR</a></h1>
<p>DUPUIS Arnaud, <code>&lt;a.dupuis@infinityperl.org&gt;</code></p>
<p>
<a href="#__index__"><small>Top</small></a>
</p>
<hr />
<h1><a name="bugs">BUGS</a></h1>
<p>Please report any bugs or feature requests to
<code>bug-slackget10-file@rt.cpan.org</code>, or through the web interface at
<a href="http://rt.cpan.org/NoAuth/ReportBug.html?Queue=slackget10">http://rt.cpan.org/NoAuth/ReportBug.html</a>.
I will be notified, and then you'll automatically be notified of progress on
your bug as I make changes.</p>
<p>
<a href="#__index__"><small>Top</small></a>
</p>
<hr />
<h1><a name="acknowledgements">ACKNOWLEDGEMENTS</a></h1>
<p>
<a href="#__index__"><small>Top</small></a>
</p>
<hr />
<h1><a name="copyright___license">COPYRIGHT &amp; LICENSE</a></h1>
<p>Copyright 2005 DUPUIS Arnaud, All Rights Reserved.</p>
<p>This program is free software; you can redistribute it and/or modify it
under the same terms as Perl itself.</p>
<p><a href="#__index__"><small>Top</small></a></p>

</body>

</html>
